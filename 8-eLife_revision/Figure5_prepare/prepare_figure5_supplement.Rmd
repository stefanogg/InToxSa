---
title: "Prepare figure 5 - figure supplements"
author: "Stefano Giulieri"
date: "08/03/2023"
output:
  html_document:
    toc: TRUE
---

```{r setup, include=F}
knitr::opts_chunk$set(echo = TRUE)
setwd(stringr::str_c(here::here(), "/8-eLife_revision/Figure5_prepare"))
msg <- glue::glue("My directory is {getwd()}")
message(msg)
```

Here we prepare the figures supplements for figure 5


```{r message=FALSE}
library(tidyverse)
library(patchwork)
library(cols4all)
rm(list = ls())
```

# Set theme

```{r}
theme_set(theme_bw(base_size = 16))
theme_update( text = element_text(face = "bold"))
```

# Pair with PI decreease *and* increase

```{r}
plot_list <- readRDS("../Genetic_pairs/processed_data/gene_convergence/PI_discordant_with_PI_increase/convergence_plots_diffPI.Rda")
wrap_plots(plot_list) +
  plot_annotation(tag_levels = "A")
```


```{r}
# ggsave("figures/Figure5_figure_supplement1.pdf")
```

# Compare PI uptake

```{r}
plot_list <- readRDS("../Genetic_pairs/processed_data/gene_convergence/compare_PI_uptake_between_independent_pairs/comparison_plots.Rda")
df_lm_tidy <- readRDS("../Genetic_pairs/processed_data/gene_convergence/compare_PI_uptake_between_independent_pairs/comparison_df.Rda")[[3]]
(p1 <- plot_list[[1]] +
    labs(y = "Median\ndelta PI") +
    scale_fill_manual(values = c("red", "blue"), labels = c("pairs without\nmutations", "pairs with\nmutations"),
                      name = ""))
(p2 <- plot_list[[2]] +
    geom_hline(yintercept = 0) +
    labs(y = "Regression\ncoefficient beta") +
    scale_colour_brewer(palette = "YlGnBu") +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none"))
wrap_plots(p1, p2) +
  plot_annotation(tag_levels = "A") +
  plot_layout(guides = "collect")
```

```{r}
# ggsave("figures/Figure5_figure_supplement2.pdf")
```


