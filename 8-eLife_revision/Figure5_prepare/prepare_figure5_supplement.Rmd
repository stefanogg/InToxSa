---
title: "Prepare figure 5 - figure supplements"
author: "Stefano Giulieri"
date: "08/03/2023"
output:
  html_document:
    toc: TRUE
---

```{r setup, include=F}
knitr::opts_chunk$set(echo = TRUE)
setwd(stringr::str_c("~/Documents/Github/InToxSa", "/8-eLife_revision/Figure5_prepare"))
msg <- glue::glue("My directory is {getwd()}")
message(msg)
```

Here we prepare the figures supplements for figure 5


```{r message=FALSE}
library(tidyverse)
library(patchwork)
library(cols4all)
rm(list = ls())
```

# Pairs with no / minimal PI change

```{r}
plot_list <- readRDS("../Genetic_pairs/processed_data/gene_convergence/PI_similar/convergence_plots_eqPI.Rda")
wrap_plots(plot_list) +
  plot_annotation(tag_levels = "A")

```

```{r}
ggsave("figures/Figure5_figure_supplement2.pdf")
```

# Compare PI uptake

```{r}
plot_list <- readRDS("../Genetic_pairs/processed_data/gene_convergence/compare_PI_uptake_between_independent_pairs/comparison_plots.Rda")
(p1 <- plot_list[[1]] +
    labs(y = "Median\ndelta PI") +
    scale_fill_manual(values = c("red", "blue"), labels = c("pairs without\nmutations", "pairs with\nmutations"),
                      name = ""))
(p2 <- plot_list[[3]] +
    labs(y = "Regression\ncoefficient beta") +
    scale_colour_brewer(palette = "YlGnBu") +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none"))
wrap_plots(p1, p2) +
  plot_annotation(tag_levels = "A") +
  plot_layout(guides = "collect")
```

```{r}
ggsave("figures/Figure5_figure_supplement1.pdf")
```
