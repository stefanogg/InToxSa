% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Operetta\_analysis\_spots\_THP1.R},
  pdfauthor={rguerillot},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Operetta\_analysis\_spots\_THP1.R}
\author{rguerillot}
\date{2021-10-27}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.0.4     v dplyr   1.0.2
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"/home/rguerillot/Documents/Travail/Abdou\_project/Staph\_infection\_project/github\_analysis/VANANZ\_phenotypes"}\NormalTok{)}

\CommentTok{\# import cell count operetta data}
\NormalTok{read\_tsv\_filename }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(flnm) \{}
  \FunctionTok{read\_tsv}\NormalTok{(flnm, }\AttributeTok{skip =} \DecValTok{9}\NormalTok{, }\AttributeTok{trim\_ws =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{filename =}\NormalTok{ flnm)}
\NormalTok{\}}

\NormalTok{Spot\_count.df }\OtherTok{\textless{}{-}}\FunctionTok{list.files}\NormalTok{(}\AttributeTok{path =} \StringTok{"Operetta/raw\_data/210921 THP1 n2/"}\NormalTok{, }\AttributeTok{pattern =} \StringTok{"*Spots"}\NormalTok{, }\AttributeTok{full.names =}\NormalTok{ T, }\AttributeTok{recursive =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{map\_df}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{read\_tsv\_filename}\NormalTok{(.)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   `Bounding Box` = col_character()
## )
## i Use `spec()` for the full column specifications.
\end{verbatim}

\begin{verbatim}
## ! Multiple files in zip: reading ''_rels/.rels''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   `Bounding Box` = col_character()
## )
## i Use `spec()` for the full column specifications.
\end{verbatim}

\begin{verbatim}
## ! Multiple files in zip: reading ''[Content_Types].xml''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   `Bounding Box` = col_character()
## )
## i Use `spec()` for the full column specifications.
\end{verbatim}

\begin{verbatim}
## ! Multiple files in zip: reading ''[Content_Types].xml''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(Spot\_count.df}\SpecialCharTok{$}\NormalTok{filename)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Operetta/raw_data/210921 THP1 n2//210921_THP1_1.5h_Objects_Population - Spots.tsv"
## [2] "Operetta/raw_data/210921 THP1 n2//210921_THP1_24h_Objects_Population - Spots.tsv" 
## [3] "Operetta/raw_data/210921 THP1 n2//210921_THP1_5h_Objects_Population - Spots.tsv"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tidy Operetta combined dataframe}

\CommentTok{\#names(Spot\_count.df) \textless{}{-} gsub(" ", "\_", names(Spot\_count.df))}
\CommentTok{\#names(Spot\_count.df) \textless{}{-} gsub("Cells\_{-}\_", "", names(Spot\_count.df))}
\NormalTok{Spot\_count\_clean.df }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{separate}\NormalTok{(}\AttributeTok{col =}\NormalTok{ filename, }\AttributeTok{sep =} \StringTok{"/"}\NormalTok{, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{,}\StringTok{"b"}\NormalTok{,}\StringTok{"c"}\NormalTok{, }\StringTok{"d"}\NormalTok{, }\StringTok{"experiment\_id"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{separate}\NormalTok{(}\AttributeTok{col =}\NormalTok{ experiment\_id, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"plate\_date"}\NormalTok{, }\StringTok{"cell\_type"}\NormalTok{, }\StringTok{"timepoint"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"f"}\NormalTok{), }\AttributeTok{remove =}\NormalTok{ F) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a, }\SpecialCharTok{{-}}\NormalTok{b, }\SpecialCharTok{{-}}\NormalTok{d, }\SpecialCharTok{{-}}\NormalTok{e, }\SpecialCharTok{{-}}\NormalTok{f, }\SpecialCharTok{{-}}\NormalTok{X1, }\SpecialCharTok{{-}}\NormalTok{Timepoint) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Row =} \FunctionTok{as.character}\NormalTok{(Row)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \FunctionTok{ifelse}\NormalTok{(Strain }\SpecialCharTok{==} \StringTok{"Non{-}infected"}\NormalTok{, }\AttributeTok{yes =} \StringTok{"non{-}infected"}\NormalTok{, }\AttributeTok{no =} \FunctionTok{as.character}\NormalTok{(Strain))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{==} \StringTok{"THP1 Casp1{-}/{-}"}\NormalTok{, }\AttributeTok{yes =} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{, }\AttributeTok{no =} \FunctionTok{as.character}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{))) }
  

\NormalTok{raw\_to\_ABC.df }\OtherTok{\textless{}{-}} \FunctionTok{data\_frame}\NormalTok{(}\AttributeTok{Row =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{), }\AttributeTok{row =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{,}\StringTok{"B"}\NormalTok{,}\StringTok{"C"}\NormalTok{,}\StringTok{"D"}\NormalTok{,}\StringTok{"E"}\NormalTok{,}\StringTok{"F"}\NormalTok{,}\StringTok{"G"}\NormalTok{,}\StringTok{"H"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Row =} \FunctionTok{as.character}\NormalTok{(Row))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `data_frame()` was deprecated in tibble 1.1.0.
## Please use `tibble()` instead.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Spot\_count\_clean.df }\OtherTok{\textless{}{-}} \FunctionTok{left\_join}\NormalTok{(Spot\_count\_clean.df, raw\_to\_ABC.df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Row) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\AttributeTok{Row =}\NormalTok{ row, Column, }\FunctionTok{everything}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Column =} \FunctionTok{str\_pad}\NormalTok{(Column, }\DecValTok{2}\NormalTok{, }\AttributeTok{pad =} \StringTok{"0"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Well =} \FunctionTok{paste0}\NormalTok{(Row, Column)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(Well, }\FunctionTok{everything}\NormalTok{(), }\SpecialCharTok{{-}}\NormalTok{Replicate) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sample\_id =} \FunctionTok{paste}\NormalTok{(experiment\_id, Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, }\AttributeTok{sep =} \StringTok{"\#"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Joining, by = "Row"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create df of replicate}
\NormalTok{sample\_replicate\_df }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(experiment\_id, Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(experiment\_id, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{replicate =} \FunctionTok{row\_number}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\CommentTok{\# merge with clean data}
\NormalTok{Spot\_count\_clean.df }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(Spot\_count\_clean.df, sample\_replicate\_df, }\AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"experiment\_id"}\NormalTok{, }\StringTok{"Well"}\NormalTok{, }\StringTok{"Cell Type"}\NormalTok{, }\StringTok{"Strain"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{timepoint =} \FunctionTok{factor}\NormalTok{(timepoint, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"1.5h"}\NormalTok{, }\StringTok{"5h"}\NormalTok{, }\StringTok{"24h"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \FunctionTok{factor}\NormalTok{(Strain, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"WT"}\NormalTok{, }\StringTok{"agrA"}\NormalTok{, }\StringTok{"non{-}infected"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"THP1 (Cas9)"}\NormalTok{, }\StringTok{"THP1 casp1{-}/{-}"}\NormalTok{, }\StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{))) }
  
  



\CommentTok{\# count bacteria per field}
\NormalTok{bac\_count\_field }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of bacteria/field"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(bac\_count\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Strain, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
\CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# count infected cells}
\NormalTok{bac\_count\_infected }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Spots {-} Object No in Cells}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of infected cells/field"}\NormalTok{)}


\CommentTok{\# count bacteria per cell}
\NormalTok{bac\_count\_cell }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field, }\StringTok{\textasciigrave{}}\AttributeTok{Spots {-} Object No in Cells}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of bacteria/infected cell"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of infected cells"}\NormalTok{)}
  

\FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(Strain }\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}\SpecialCharTok{+}
  \FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 11 rows containing missing values (stat_boxplot).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 15 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Strain}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Strain}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}\SpecialCharTok{+}
  \FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 11 rows containing missing values (stat_boxplot).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 19 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot as specified by Abdou}


\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"intracellular bacteria per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p1}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_field }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"intracellular bacteria per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p2}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_field }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"intracellular bacteria per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p3}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p4 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p4}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p5 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                                 \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p5}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p6 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                   \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p6}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# idem without points}


\NormalTok{p7 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                                 \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \CommentTok{\#geom\_point(position=position\_jitterdodge(jitter.width = .15, jitter.height = .15),alpha=0.3, , colour = "black") +}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p7}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-10.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p8 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                   \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \CommentTok{\#geom\_point(position=position\_jitterdodge(jitter.width = .15, jitter.height = .15),alpha=0.3, , colour = "black") +}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p8}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-11.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p9 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_cell }\SpecialCharTok{\%\textgreater{}\%}
               \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{)}
\NormalTok{             , }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                   \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \CommentTok{\#geom\_point(position=position\_jitterdodge(jitter.width = .15, jitter.height = .15),alpha=0.3, , colour = "black") +}
  \FunctionTok{facet\_grid}\NormalTok{(Strain}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous limits supplied to discrete scale.
## Did you mean `limits = factor(...)` or `scale_*_continuous()`?
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p9}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot total number of infected cells}

\NormalTok{p10 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_infected, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"infected cells per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p10}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-13.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p11 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_infected }\SpecialCharTok{\%\textgreater{}\%} 
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"infected cells per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p11}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-14.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p12 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bac\_count\_infected }\SpecialCharTok{\%\textgreater{}\%} 
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"infected cells per field"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p12}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-15.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# note: umber of infected increase for agrA between 5h and 24h {-}\textgreater{} less seeded cells on 5h plate?? =\textgreater{} need to correct by total number of cells}

\CommentTok{\# Plot total nb cells and pct f infected cells {-}{-}{-}{-}}

\NormalTok{Cell\_count.df }\OtherTok{\textless{}{-}}\FunctionTok{list.files}\NormalTok{(}\AttributeTok{path =} \StringTok{"Operetta/raw\_data/210921 THP1 n2/"}\NormalTok{, }\AttributeTok{pattern =} \StringTok{"*Cells"}\NormalTok{, }\AttributeTok{full.names =}\NormalTok{ T, }\AttributeTok{recursive =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{map\_df}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{read\_tsv\_filename}\NormalTok{(.)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   Replicate = col_double(),
##   Row = col_double(),
##   Column = col_double(),
##   Plane = col_double(),
##   Timepoint = col_double(),
##   Field = col_double(),
##   `Object No` = col_double(),
##   X = col_double(),
##   Y = col_double(),
##   `Bounding Box` = col_character(),
##   `Cells - Total Spot Area` = col_double(),
##   `Cells - Relative Spot Intensity` = col_double(),
##   `Cells - Number of Spots` = col_double(),
##   `Cells - Number of Spots per Area of Cell` = col_double(),
##   `Cells - Spots per Cell Mean` = col_double()
## )
## 
## ! Multiple files in zip: reading ''[Content_Types].xml''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   Replicate = col_double(),
##   Row = col_double(),
##   Column = col_double(),
##   Plane = col_double(),
##   Field = col_double(),
##   `Object No` = col_double(),
##   X = col_double(),
##   Y = col_double(),
##   `Bounding Box` = col_character(),
##   `Cells - Total Spot Area` = col_double(),
##   `Cells - Relative Spot Intensity` = col_double(),
##   `Cells - Number of Spots` = col_double(),
##   `Cells - Number of Spots per Area of Cell` = col_double(),
##   `Cells - Spots per Cell Mean` = col_double()
## )
\end{verbatim}

\begin{verbatim}
## ! Multiple files in zip: reading ''[Content_Types].xml''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   `Cell Type` = col_character(),
##   Strain = col_character(),
##   Replicate = col_double(),
##   Row = col_double(),
##   Column = col_double(),
##   Plane = col_double(),
##   Field = col_double(),
##   `Object No` = col_double(),
##   X = col_double(),
##   Y = col_double(),
##   `Bounding Box` = col_character(),
##   `Cells - Total Spot Area` = col_double(),
##   `Cells - Relative Spot Intensity` = col_double(),
##   `Cells - Number of Spots` = col_double(),
##   `Cells - Number of Spots per Area of Cell` = col_double(),
##   `Cells - Spots per Cell Mean` = col_double()
## )
\end{verbatim}

\begin{verbatim}
## ! Multiple files in zip: reading ''[Content_Types].xml''
\end{verbatim}

\begin{verbatim}
## Warning: Missing column names filled in: 'X1' [1]
\end{verbatim}

\begin{verbatim}
## 
## -- Column specification --------------------------------------------------------
## cols(
##   X1 = col_character()
## )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(Spot\_count.df}\SpecialCharTok{$}\NormalTok{filename)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Operetta/raw_data/210921 THP1 n2//210921_THP1_1.5h_Objects_Population - Spots.tsv"
## [2] "Operetta/raw_data/210921 THP1 n2//210921_THP1_24h_Objects_Population - Spots.tsv" 
## [3] "Operetta/raw_data/210921 THP1 n2//210921_THP1_5h_Objects_Population - Spots.tsv"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Cell\_count\_clean.df }\OtherTok{\textless{}{-}}\NormalTok{ Cell\_count.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{separate}\NormalTok{(}\AttributeTok{col =}\NormalTok{ filename, }\AttributeTok{sep =} \StringTok{"/"}\NormalTok{, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{,}\StringTok{"b"}\NormalTok{,}\StringTok{"c"}\NormalTok{, }\StringTok{"d"}\NormalTok{, }\StringTok{"experiment\_id"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{separate}\NormalTok{(}\AttributeTok{col =}\NormalTok{ experiment\_id, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"plate\_date"}\NormalTok{, }\StringTok{"cell\_type"}\NormalTok{, }\StringTok{"timepoint"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"f"}\NormalTok{), }\AttributeTok{remove =}\NormalTok{ F) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a, }\SpecialCharTok{{-}}\NormalTok{b, }\SpecialCharTok{{-}}\NormalTok{c, }\SpecialCharTok{{-}}\NormalTok{d, }\SpecialCharTok{{-}}\NormalTok{e, }\SpecialCharTok{{-}}\NormalTok{f, }\SpecialCharTok{{-}}\NormalTok{X1, }\SpecialCharTok{{-}}\NormalTok{Timepoint) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Row =} \FunctionTok{as.character}\NormalTok{(Row)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \FunctionTok{ifelse}\NormalTok{(Strain }\SpecialCharTok{==} \StringTok{"Non{-}infected"}\NormalTok{, }\AttributeTok{yes =} \StringTok{"non{-}infected"}\NormalTok{, }\AttributeTok{no =} \FunctionTok{as.character}\NormalTok{(Strain))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{==} \StringTok{"THP1 Casp1{-}/{-}"}\NormalTok{, }\AttributeTok{yes =} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{, }\AttributeTok{no =} \FunctionTok{as.character}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{( }\AttributeTok{Cells =} \FunctionTok{ifelse}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cells {-} Number of Spots}\StringTok{\textasciigrave{}} \SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{, }\AttributeTok{yes =} \StringTok{"infected cells"}\NormalTok{, }\StringTok{"non{-}infected cells"}\NormalTok{))  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{timepoint =} \FunctionTok{factor}\NormalTok{(timepoint, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"1.5h"}\NormalTok{, }\StringTok{"5h"}\NormalTok{, }\StringTok{"24h"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \FunctionTok{factor}\NormalTok{(Strain, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"WT"}\NormalTok{, }\StringTok{"agrA"}\NormalTok{, }\StringTok{"non{-}infected"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"THP1 (Cas9)"}\NormalTok{, }\StringTok{"THP1 casp1{-}/{-}"}\NormalTok{, }\StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{))) }



\NormalTok{total\_cells\_per\_field }\OtherTok{\textless{}{-}}\NormalTok{ Cell\_count\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(timepoint,  Row, Column, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, Replicate, Field) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of cells"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\NormalTok{infected\_cells\_per\_field }\OtherTok{\textless{}{-}}\NormalTok{ Cell\_count\_clean.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Cells }\SpecialCharTok{==} \StringTok{"infected cells"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint,  Row, Column, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, Replicate, Field) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of infected cells"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\NormalTok{pct\_infected\_cells\_per\_field }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(total\_cells\_per\_field, infected\_cells\_per\_field,}
                                      \AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"timepoint"}\NormalTok{, }\StringTok{"Row"}\NormalTok{, }\StringTok{"Column"}\NormalTok{, }\StringTok{"Cell Type"}\NormalTok{, }\StringTok{"Strain"}\NormalTok{, }\StringTok{"Replicate"}\NormalTok{, }\StringTok{"Field"}\NormalTok{),}
                                      \AttributeTok{all.x =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{),}\AttributeTok{yes =} \DecValTok{0}\NormalTok{, }\AttributeTok{no =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{\% of infected cells}\StringTok{\textasciigrave{}} \OtherTok{=}\NormalTok{ (}\StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\SpecialCharTok{/}\StringTok{\textasciigrave{}}\AttributeTok{number of cells}\StringTok{\textasciigrave{}}\NormalTok{)}\SpecialCharTok{*}\DecValTok{100}\NormalTok{)}


\NormalTok{p13 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p13}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-16.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p14 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p14}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-17.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p15 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{\% of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
\CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p15}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-18.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p16 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p16}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-19.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p17 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p17}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-20.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p18 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp{-}4/5 {-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{\% of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p18}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-21.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p19 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p19}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-22.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p20 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p20}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-23.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p21 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(pct\_infected\_cells\_per\_field }\SpecialCharTok{\%\textgreater{}\%}
                \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{!=} \StringTok{"THP1 casp1{-}/{-}"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{\% of infected cells}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Strain) }\SpecialCharTok{+}
  \CommentTok{\#  ylab("intracellular bacteria per field") +}
  \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{p21}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-24.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# check signals differences infected vs non{-}infected and try to remove background bact. counts in non{-}infected {-}{-}{-}{-}}
\NormalTok{ninf.df }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Strain }\SpecialCharTok{==} \StringTok{"non{-}infected"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"Spots"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gather}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \StringTok{"non{-}infected"}\NormalTok{)}

\NormalTok{inf.df }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Strain }\SpecialCharTok{!=} \StringTok{"non{-}infected"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"Spots"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gather}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Strain =} \StringTok{"infected"}\NormalTok{)}

\NormalTok{ninf\_inf.df }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(ninf.df, inf.df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(value))}

\FunctionTok{unique}\NormalTok{(ninf\_inf.df}\SpecialCharTok{$}\NormalTok{key)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "Spots - Relative Spot  Intensity"        
##  [2] "Spots - Corrected Spot  Intensity"       
##  [3] "Spots - Uncorrected Spot  Peak Intensity"
##  [4] "Spots - Spot Contrast"                   
##  [5] "Spots - Spot Background Intensity"       
##  [6] "Spots - Spot Area [px]"                 
##  [7] "Spots - Region Intensity"                
##  [8] "Spots - Spot To Region Intensity"        
##  [9] "Spots - Object No in Cells"              
## [10] "Spots - Spot Area [px]"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(ninf\_inf.df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{colour =}\NormalTok{ Strain)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ key, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-25.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(ninf\_inf.df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{colour =}\NormalTok{ Strain)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ key, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 18859 rows containing non-finite values (stat_density).
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <89>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : conversion failure on 'Spots - Spot Area [px]' in 'mbcsToSbcs': dot
## substituted for <a4>
\end{verbatim}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-26.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# based on distribution backround spot/bacteria can be removed by filtering Spot area \textgreater{} 37.5}

\NormalTok{Spot\_count\_clean\_clean.df }\OtherTok{\textless{}{-}}\NormalTok{  Spot\_count\_clean.df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Spots {-} Spot Area [px]}\StringTok{\textasciigrave{}} \SpecialCharTok{\textless{}} \FloatTok{37.5}\NormalTok{)}

\CommentTok{\# Count and re plot after filter}
\NormalTok{bac\_count\_field }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of bacteria/field"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(bac\_count\_field, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Strain, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/field}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =} \DecValTok{0}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#  geom\_jitter(width = .2, alpha= .3) +}
  \FunctionTok{facet\_grid}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-27.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# count bacteria per cell}
\NormalTok{bac\_count\_cell }\OtherTok{\textless{}{-}}\NormalTok{ Spot\_count\_clean.df  }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field, }\StringTok{\textasciigrave{}}\AttributeTok{Spots {-} Object No in Cells}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{name =} \StringTok{"number of bacteria/infected cell"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint,  Well, }\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, Strain, replicate, Field, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{()}


\FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =}\NormalTok{ n, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(Strain }\SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}\SpecialCharTok{+}
  \FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 11 rows containing missing values (stat_boxplot).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (geom_segment).

## Warning: Removed 1 rows containing missing values (geom_segment).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 14 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-28.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(bac\_count\_cell, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y =}\NormalTok{ n, }\AttributeTok{fill =} \StringTok{\textasciigrave{}}\AttributeTok{Strain}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{group =}  \FunctionTok{interaction}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Strain}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{number of bacteria/infected cell}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge2"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position=}\FunctionTok{position\_jitterdodge}\NormalTok{(}\AttributeTok{jitter.width =}\NormalTok{ .}\DecValTok{15}\NormalTok{, }\AttributeTok{jitter.height =}\NormalTok{ .}\DecValTok{15}\NormalTok{),}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, , }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Cell Type}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}}\NormalTok{timepoint)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Operetta_analysis_spots_THP1_files/figure-latex/unnamed-chunk-1-29.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <ScaleContinuousPosition>
##  Range:  
##  Limits:    0 --    7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Note: doesn\textquotesingle{}t work remove most of the data}
\end{Highlighting}
\end{Shaded}


\end{document}
